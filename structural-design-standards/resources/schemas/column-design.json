{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://structural-standards.org/schemas/column-design.json",
  "title": "Column Design Input/Output Schema",
  "description": "JSON schema for validating column design input parameters and output results",
  "type": "object",
  "definitions": {
    "geometry": {
      "type": "object",
      "properties": {
        "width": {
          "type": "number",
          "minimum": 200,
          "maximum": 3000,
          "description": "Column width in mm"
        },
        "depth": {
          "type": "number",
          "minimum": 200,
          "maximum": 3000,
          "description": "Column depth in mm"
        },
        "length": {
          "type": "number",
          "minimum": 1000,
          "maximum": 20000,
          "description": "Column length in mm"
        },
        "cover": {
          "type": "number",
          "minimum": 15,
          "maximum": 100,
          "description": "Concrete cover in mm"
        },
        "diameter": {
          "type": "number",
          "minimum": 200,
          "maximum": 3000,
          "description": "Column diameter for circular columns in mm"
        }
      },
      "anyOf": [
        {
          "required": ["width", "depth", "length", "cover"]
        },
        {
          "required": ["diameter", "length", "cover"]
        }
      ],
      "additionalProperties": false
    },
    "loads": {
      "type": "object",
      "properties": {
        "axial_dead": {
          "type": "number",
          "minimum": 0,
          "maximum": 50000,
          "description": "Axial dead load in kN"
        },
        "axial_live": {
          "type": "number",
          "minimum": 0,
          "maximum": 50000,
          "description": "Axial live load in kN"
        },
        "moment_x_dead": {
          "type": "number",
          "minimum": 0,
          "maximum": 10000,
          "description": "Moment about X-axis (dead) in kN⋅m"
        },
        "moment_x_live": {
          "type": "number",
          "minimum": 0,
          "maximum": 10000,
          "description": "Moment about X-axis (live) in kN⋅m"
        },
        "moment_y_dead": {
          "type": "number",
          "minimum": 0,
          "maximum": 10000,
          "description": "Moment about Y-axis (dead) in kN⋅m"
        },
        "moment_y_live": {
          "type": "number",
          "minimum": 0,
          "maximum": 10000,
          "description": "Moment about Y-axis (live) in kN⋅m"
        },
        "wind_load_x": {
          "type": "number",
          "minimum": 0,
          "maximum": 5000,
          "description": "Wind load in X-direction in kN"
        },
        "wind_load_y": {
          "type": "number",
          "minimum": 0,
          "maximum": 5000,
          "description": "Wind load in Y-direction in kN"
        },
        "seismic_load": {
          "type": "number",
          "minimum": 0,
          "maximum": 5000,
          "description": "Seismic load in kN"
        }
      },
      "required": ["axial_dead", "axial_live"],
      "additionalProperties": false
    },
    "column_result": {
      "type": "object",
      "properties": {
        "overall_status": {
          "type": "string",
          "enum": ["PASS", "FAIL", "WARNING", "ERROR"],
          "description": "Overall design status"
        },
        "design_loads": {
          "type": "object",
          "properties": {
            "factored_axial": {
              "type": "number",
              "description": "Factored axial load in kN"
            },
            "factored_moment_x": {
              "type": "number",
              "description": "Factored moment about X-axis in kN⋅m"
            },
            "factored_moment_y": {
              "type": "number",
              "description": "Factored moment about Y-axis in kN⋅m"
            }
          },
          "required": ["factored_axial"],
          "additionalProperties": true
        },
        "slenderness_analysis": {
          "type": "object",
          "properties": {
            "slenderness_ratio_x": {
              "type": "number",
              "description": "Slenderness ratio about X-axis"
            },
            "slenderness_ratio_y": {
              "type": "number", 
              "description": "Slenderness ratio about Y-axis"
            },
            "effective_length_x": {
              "type": "number",
              "description": "Effective length about X-axis in mm"
            },
            "effective_length_y": {
              "type": "number",
              "description": "Effective length about Y-axis in mm"
            },
            "is_slender": {
              "type": "boolean",
              "description": "Whether column is slender"
            },
            "magnification_factor_x": {
              "type": "number",
              "description": "Moment magnification factor about X-axis"
            },
            "magnification_factor_y": {
              "type": "number",
              "description": "Moment magnification factor about Y-axis"
            }
          },
          "additionalProperties": true
        },
        "interaction_analysis": {
          "type": "object",
          "properties": {
            "interaction_ratio": {
              "type": "number",
              "minimum": 0,
              "maximum": 2.0,
              "description": "P-M interaction ratio"
            },
            "biaxial_ratio": {
              "type": "number",
              "minimum": 0,
              "maximum": 2.0,
              "description": "Biaxial bending interaction ratio"
            },
            "control_condition": {
              "type": "string",
              "enum": ["compression_controlled", "tension_controlled", "transition"],
              "description": "Failure mode control condition"
            }
          },
          "additionalProperties": true
        },
        "required_reinforcement": {
          "type": "object",
          "properties": {
            "required_steel_area": {
              "type": "number",
              "minimum": 0,
              "description": "Required steel area in mm²"
            },
            "minimum_steel_area": {
              "type": "number",
              "minimum": 0,
              "description": "Minimum steel area in mm²"
            },
            "maximum_steel_area": {
              "type": "number",
              "minimum": 0,
              "description": "Maximum steel area in mm²"
            },
            "steel_ratio": {
              "type": "number",
              "minimum": 0,
              "maximum": 0.08,
              "description": "Steel ratio"
            },
            "bar_arrangement": {
              "type": "object",
              "properties": {
                "corner_bars": {
                  "type": "integer",
                  "minimum": 4,
                  "description": "Number of corner bars"
                },
                "intermediate_bars": {
                  "type": "integer",
                  "minimum": 0,
                  "description": "Number of intermediate bars"
                },
                "bar_size": {
                  "type": "string",
                  "description": "Reinforcement bar size"
                }
              },
              "additionalProperties": true
            }
          },
          "required": ["required_steel_area"],
          "additionalProperties": true
        },
        "tie_reinforcement": {
          "type": "object",
          "properties": {
            "tie_size": {
              "type": "string",
              "description": "Tie bar size designation"
            },
            "tie_spacing": {
              "type": "number",
              "minimum": 50,
              "maximum": 500,
              "description": "Tie spacing in mm"
            },
            "seismic_detailing": {
              "type": "boolean",
              "description": "Whether seismic detailing is required"
            }
          },
          "additionalProperties": true
        },
        "utilization_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 2.0,
          "description": "Overall utilization ratio"
        },
        "error_message": {
          "type": "string",
          "description": "Error message if design failed"
        }
      },
      "required": ["overall_status"],
      "additionalProperties": true
    }
  },
  "oneOf": [
    {
      "title": "Column Design Input",
      "properties": {
        "type": {
          "const": "column_design_input"
        },
        "standard": {
          "type": "string",
          "enum": ["ACI318M25", "ThaiMinistry2566", "Eurocode2", "AS3600"],
          "description": "Design standard to use"
        },
        "column_type": {
          "type": "string",
          "enum": ["tied", "spiral", "composite"],
          "description": "Column type"
        },
        "cross_section": {
          "type": "string",
          "enum": ["rectangular", "circular", "L-shaped", "T-shaped"],
          "description": "Cross-section shape"
        },
        "geometry": {
          "$ref": "#/definitions/geometry"
        },
        "materials": {
          "type": "object",
          "properties": {
            "concrete": {
              "type": "object",
              "properties": {
                "fc_prime": {
                  "type": "number",
                  "minimum": 15,
                  "maximum": 100,
                  "description": "Concrete compressive strength in MPa"
                },
                "unit_weight": {
                  "type": "number",
                  "minimum": 20,
                  "maximum": 30,
                  "description": "Concrete unit weight in kN/m³"
                }
              },
              "required": ["fc_prime"],
              "additionalProperties": true
            },
            "steel": {
              "type": "object",
              "properties": {
                "fy": {
                  "type": "number",
                  "minimum": 200,
                  "maximum": 700,
                  "description": "Steel yield strength in MPa"
                },
                "grade": {
                  "type": "string",
                  "enum": ["GRADE280", "GRADE350", "GRADE420", "GRADE520", "SR24", "SD30", "SD40", "SD50"],
                  "description": "Steel grade designation"
                }
              },
              "required": ["fy", "grade"],
              "additionalProperties": true
            }
          },
          "required": ["concrete", "steel"],
          "additionalProperties": false
        },
        "loads": {
          "$ref": "#/definitions/loads"
        },
        "end_conditions": {
          "type": "object",
          "properties": {
            "top_end": {
              "type": "string",
              "enum": ["pinned", "fixed", "free"],
              "description": "Top end condition"
            },
            "bottom_end": {
              "type": "string", 
              "enum": ["pinned", "fixed", "free"],
              "description": "Bottom end condition"
            },
            "effective_length_factor_x": {
              "type": "number",
              "minimum": 0.5,
              "maximum": 2.5,
              "description": "Effective length factor about X-axis"
            },
            "effective_length_factor_y": {
              "type": "number",
              "minimum": 0.5,
              "maximum": 2.5,
              "description": "Effective length factor about Y-axis"
            }
          },
          "additionalProperties": true
        }
      },
      "required": ["type", "standard", "column_type", "geometry", "materials", "loads"],
      "additionalProperties": false
    },
    {
      "title": "Column Design Output",
      "properties": {
        "type": {
          "const": "column_design_output"
        },
        "input": {
          "type": "object",
          "description": "Original input parameters"
        },
        "result": {
          "$ref": "#/definitions/column_result"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Calculation timestamp"
        },
        "calculation_time": {
          "type": "number",
          "minimum": 0,
          "description": "Calculation time in seconds"
        },
        "software_version": {
          "type": "string",
          "description": "Software version used"
        }
      },
      "required": ["type", "result"],
      "additionalProperties": false
    }
  ]
}