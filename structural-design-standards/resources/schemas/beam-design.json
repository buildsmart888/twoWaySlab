{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://structural-standards.org/schemas/beam-design.json",
  "title": "Beam Design Input/Output Schema",
  "description": "JSON schema for validating beam design input parameters and output results",
  "type": "object",
  "definitions": {
    "geometry": {
      "type": "object",
      "properties": {
        "width": {
          "type": "number",
          "minimum": 100,
          "maximum": 2000,
          "description": "Beam width in mm"
        },
        "height": {
          "type": "number", 
          "minimum": 150,
          "maximum": 3000,
          "description": "Beam height in mm"
        },
        "effective_depth": {
          "type": "number",
          "minimum": 50,
          "maximum": 2900,
          "description": "Effective depth in mm"
        },
        "span_length": {
          "type": "number",
          "minimum": 1000,
          "maximum": 50000,
          "description": "Span length in mm"
        }
      },
      "required": ["width", "height", "effective_depth", "span_length"],
      "additionalProperties": false
    },
    "materials": {
      "type": "object",
      "properties": {
        "concrete": {
          "type": "object",
          "properties": {
            "fc_prime": {
              "type": "number",
              "minimum": 15,
              "maximum": 100,
              "description": "Concrete compressive strength in MPa"
            },
            "unit_weight": {
              "type": "number",
              "minimum": 20,
              "maximum": 30,
              "description": "Concrete unit weight in kN/m³"
            },
            "elastic_modulus": {
              "type": "number",
              "minimum": 15000,
              "maximum": 50000,
              "description": "Elastic modulus in MPa"
            }
          },
          "required": ["fc_prime"],
          "additionalProperties": true
        },
        "steel": {
          "type": "object",
          "properties": {
            "fy": {
              "type": "number",
              "minimum": 200,
              "maximum": 700,
              "description": "Steel yield strength in MPa"
            },
            "grade": {
              "type": "string",
              "enum": ["GRADE280", "GRADE350", "GRADE420", "GRADE520", "SR24", "SD30", "SD40", "SD50"],
              "description": "Steel grade designation"
            },
            "bar_designation": {
              "type": "string",
              "pattern": "^(10M|15M|20M|25M|30M|35M|45M|55M|DB9|DB10|DB12|DB16|DB20|DB25|DB32|DB40)$",
              "description": "Reinforcement bar designation"
            }
          },
          "required": ["fy", "grade"],
          "additionalProperties": true
        }
      },
      "required": ["concrete", "steel"],
      "additionalProperties": false
    },
    "loads": {
      "type": "object",
      "properties": {
        "dead_load": {
          "type": "number",
          "minimum": 0,
          "maximum": 1000,
          "description": "Dead load in kN/m"
        },
        "live_load": {
          "type": "number",
          "minimum": 0,
          "maximum": 1000,
          "description": "Live load in kN/m"
        },
        "wind_load": {
          "type": "number",
          "minimum": 0,
          "maximum": 500,
          "description": "Wind load in kN/m"
        },
        "seismic_load": {
          "type": "number",
          "minimum": 0,
          "maximum": 500,
          "description": "Seismic load in kN/m"
        },
        "point_loads": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "magnitude": {
                "type": "number",
                "minimum": 0,
                "description": "Point load magnitude in kN"
              },
              "location": {
                "type": "number",
                "minimum": 0,
                "description": "Distance from left support in mm"
              }
            },
            "required": ["magnitude", "location"]
          }
        }
      },
      "required": ["dead_load", "live_load"],
      "additionalProperties": false
    },
    "design_result": {
      "type": "object",
      "properties": {
        "overall_status": {
          "type": "string",
          "enum": ["PASS", "FAIL", "WARNING", "ERROR"],
          "description": "Overall design status"
        },
        "design_moments": {
          "type": "object",
          "properties": {
            "factored_moment": {
              "type": "number",
              "description": "Factored design moment in kN⋅m"
            },
            "service_moment": {
              "type": "number", 
              "description": "Service moment in kN⋅m"
            }
          },
          "required": ["factored_moment"],
          "additionalProperties": true
        },
        "required_reinforcement": {
          "type": "object",
          "properties": {
            "required_steel_area": {
              "type": "number",
              "minimum": 0,
              "description": "Required steel area in mm²"
            },
            "minimum_steel_area": {
              "type": "number",
              "minimum": 0,
              "description": "Minimum steel area in mm²"
            },
            "reinforcement_ratio": {
              "type": "number",
              "minimum": 0,
              "maximum": 0.1,
              "description": "Steel reinforcement ratio"
            }
          },
          "required": ["required_steel_area"],
          "additionalProperties": true
        },
        "shear_design": {
          "type": "object",
          "properties": {
            "applied_shear": {
              "type": "number",
              "description": "Applied shear force in kN"
            },
            "concrete_capacity": {
              "type": "number",
              "description": "Concrete shear capacity in kN"
            },
            "stirrup_required": {
              "type": "boolean",
              "description": "Whether stirrups are required"
            }
          },
          "additionalProperties": true
        },
        "deflection_check": {
          "type": "object",
          "properties": {
            "calculated_deflection": {
              "type": "number",
              "description": "Calculated deflection in mm"
            },
            "allowable_deflection": {
              "type": "number",
              "description": "Allowable deflection in mm"
            },
            "deflection_ratio": {
              "type": "number",
              "description": "Deflection ratio (calculated/allowable)"
            }
          },
          "additionalProperties": true
        },
        "utilization_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 2.0,
          "description": "Overall utilization ratio"
        },
        "error_message": {
          "type": "string",
          "description": "Error message if design failed"
        }
      },
      "required": ["overall_status"],
      "additionalProperties": true
    }
  },
  "oneOf": [
    {
      "title": "Beam Design Input",
      "properties": {
        "type": {
          "const": "beam_design_input"
        },
        "standard": {
          "type": "string",
          "enum": ["ACI318M25", "ThaiMinistry2566", "Eurocode2", "AS3600"],
          "description": "Design standard to use"
        },
        "beam_type": {
          "type": "string",
          "enum": ["simply_supported", "continuous", "cantilever"],
          "description": "Beam support type"
        },
        "geometry": {
          "$ref": "#/definitions/geometry"
        },
        "materials": {
          "$ref": "#/definitions/materials"
        },
        "loads": {
          "$ref": "#/definitions/loads"
        }
      },
      "required": ["type", "standard", "geometry", "materials", "loads"],
      "additionalProperties": false
    },
    {
      "title": "Beam Design Output",
      "properties": {
        "type": {
          "const": "beam_design_output"
        },
        "input": {
          "type": "object",
          "description": "Original input parameters"
        },
        "result": {
          "$ref": "#/definitions/design_result"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Calculation timestamp"
        },
        "calculation_time": {
          "type": "number",
          "minimum": 0,
          "description": "Calculation time in seconds"
        },
        "software_version": {
          "type": "string",
          "description": "Software version used"
        }
      },
      "required": ["type", "result"],
      "additionalProperties": false
    }
  ]
}